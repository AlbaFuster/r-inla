\documentclass[a4paper,11pt]{article}
\usepackage[scale={0.8,0.9},centering,includeheadfoot]{geometry}
\usepackage{amstext}
\usepackage{amsmath}
\usepackage{verbatim}
\usepackage{block}

\begin{document}
\section*{Skew-Normal likelihood}

\subsection*{Parametrisation}

The standardised Skew-Normal distribution is
\begin{displaymath}
    f(z) = \frac{2}{\omega_{\alpha}}
    \phi\left(\frac{z -\xi_{\alpha}}{\omega_{\alpha}}\right)
    \Phi\left(\alpha \frac{z -\xi_{\alpha}}{\omega_{\alpha}}\right)
\end{displaymath}
where $\omega_\alpha$ and $\xi_\alpha$ are so that the mean is zero
and variance is one, and they depends both on the skewness parameter
$\alpha$.

Let
\begin{displaymath}
    z= (y - (\eta + \mu_{\alpha}(q)))\sqrt{w \tau}
\end{displaymath}
where
\begin{description}
\item[$\eta$:] is the the linear predictor
\item[$\tau$:] is the precision
\item[$w$:] is a fixed scale or weight, $w>0$,
\item[$\mu_{\alpha}(q)$:] is the intercept parameterised by the
    quantile level $q$, and is the $q$-quantile in the standardised
    Skew-normal as a function of $\alpha$
\end{description}

\subsection*{Link-function}

The location parameter is linked to the linear predictor by
\begin{displaymath}
    \mu = \eta
\end{displaymath}

\subsection*{Hyperparameters}

The precision is represented as
\begin{displaymath}
    \theta_{1} = \log \tau
\end{displaymath}
and the prior is defined on $\theta_{1}$. 

The (standardised) skewness $\gamma$, is represented as
\begin{displaymath}
    \gamma=0.988 (2\frac{\exp(\theta_2)}{1+\exp(\theta_2)}-1)
\end{displaymath}
and the prior is defined on $\theta_{2}$. The standardised skewness
depends on $\alpha$ as
\begin{displaymath}
\gamma ={\frac  {4-\pi }{2}}{\frac{\left(\delta {\sqrt  {2/\pi
              }}\right)^{3}}{\left(1-2\delta^{2}/\pi
        \right)^{{3/2}}}}, \qquad
    \delta ={\frac{\alpha}{{\sqrt{1+\alpha^{2}}}}}
\end{displaymath}

The intercept parameter $q$, where $0<q<1$, is represented as
\begin{displaymath}
    q=\frac{\exp(\theta_3)}{1+\exp(\theta_3)}
\end{displaymath}
and the prior is defined on $\theta_3$.

The default prior for $\theta_3$ is \texttt{linksnintercept}, which is
a prior for the classical intercept $\mu_c$ as defined for the case
where $\alpha=0$, hence
\begin{displaymath}
    \mu_c =  \Phi^{-1}(q(\theta_3))
\end{displaymath}
With parameters $(a,b)$ this prior means a normal prior with mean $a$
and precision $b$ for the classical intercept $\mu_c$ which is
internally transferred to a prior for $\theta_3$. This prior make it
easier to give similar priors as in the probit case.


\subsection*{Specification}

\begin{itemize}
\item $\text{family}=\texttt{sn}$
\item Required arguments: $y$ and $w$ (keyword \texttt{scale}, and 
    $w=1$ by default).
\end{itemize}

\subsubsection*{Hyperparameter specification and default values}
\input{../hyper/likelihood/sn.tex}


\subsection*{Example}

\verbatiminput{example-sn.R}

\subsection*{Notes}

\begin{itemize}
\item This implementation replaces older ones ("sn" and "sn2") from
    $13^{\text{\emph{th}}}$ September 2020.
\item Please use \texttt{remove.names} argument to remove the
    intercept after expansion. Required if some of the fixed effects
    are factors, otherwise they do not expand correctly.
\item Using \texttt{Inf} as initial value for the intercept, will
    disable it and set $\mu_{\alpha}(q)$ identical to zero. In this
    way, the 'traditional intercept' (which is not the correct way of
    defining it though...), can be used.
\item A $N(a,0)$ prior is interpreted as a constant prior with density
    equal to one.
\item Note that the quantile formulation of the intercept, requires in
    pratice, that the intercept to be within (even more) reasonable
    bounds. If not, numerical errors can and will occur.
\end{itemize}

\end{document}

% LocalWords:  np Hyperparameters Ntrials gaussian Parametrisation skewness sn

%%% Local Variables: 
%%% TeX-master: t
%%% End: 
% LocalWords:  quantile probit Hyperparameter th
